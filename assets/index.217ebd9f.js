var S=Object.defineProperty;var O=(n,e,s)=>e in n?S(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s;var t=(n,e,s)=>(O(n,typeof e!="symbol"?e+"":e,s),s);import{P as l,p as f,F as L,A as G}from"./vendor.55cd3a4e.js";const P=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}};P();const A={type:l.AUTO,parent:"game",backgroundColor:"",transparent:!0,scale:{mode:l.Scale.FIT,width:600,height:900,autoCenter:l.Scale.CENTER_BOTH},physics:{default:"matter",matter:{gravity:{y:1}}},seed:["123"]},H={fontFamily:"'Lato', sans-serif",fontSize:"2rem",stroke:"#000",strokeThickness:2};class v extends l.GameObjects.Container{constructor(e,s,i,r,a,h=16711680,d=65280,c=20,o,M,u="left"){super(e,s,i);t(this,"width");t(this,"height");t(this,"graphicMask");t(this,"geometryMask");t(this,"background");t(this,"backgroundColor");t(this,"fill");t(this,"fillColor");t(this,"text");t(this,"icon");t(this,"max");t(this,"current");t(this,"barMax");t(this,"barCurrent");t(this,"incrementAmount");t(this,"getIconCenter",()=>({x:this.x+this.icon.x+this.icon.displayWidth/2,y:this.y+this.icon.y+this.icon.displayHeight/2}));t(this,"setMax",e=>{this.max=e,this.incrementAmount=this.width/this.max,this.barMax=this.incrementAmount*this.max,this.barCurrent=this.current*this.incrementAmount,this.text.text=`${this.current}/${this.max}`,this.scene.tweens.add({targets:this.fill,props:{width:{value:`${this.current*this.incrementAmount}`,duration:300,ease:"Power2"}}})});t(this,"setProgress",e=>{this.current=e,this.barCurrent=e*this.incrementAmount,this.text.text=`${this.current}/${this.max}`,this.scene.tweens.add({targets:this.fill,props:{width:{value:`${this.barCurrent}`,duration:300,ease:"Power2"}}})});t(this,"increaseProgress",e=>{this.current+=e,this.barCurrent+=e*this.incrementAmount,this.text.text=`${this.current}/${this.max}`,this.scene.tweens.add({targets:this.fill,props:{width:{value:`+=${e*this.incrementAmount}`,duration:300,ease:"Power2"}}})});t(this,"decreaseProgress",e=>{this.current-=e,this.barCurrent-=e*this.incrementAmount,this.text.text=`${this.current}/${this.max}`,this.scene.tweens.add({targets:this.fill,props:{width:{value:`-=${e*this.incrementAmount}`,duration:300,ease:"Power2"}}})});this.width=r,this.height=a,this.backgroundColor=h,this.fillColor=d,this.max=c,this.current=o!=null?o:c,this.incrementAmount=r/this.max,this.barMax=this.incrementAmount*this.max,this.barCurrent=this.current*this.incrementAmount,this.graphicMask=new l.GameObjects.Graphics(e).fillRoundedRect(u==="left"?this.width/7+s:s,i,this.width/7*6,a,10),this.geometryMask=new f.exports.Display.Masks.GeometryMask(e,this.graphicMask),this.background=new l.GameObjects.Rectangle(e,u==="left"?this.width/7:0,0,this.width/7*6,a,h).setOrigin(0).setMask(this.geometryMask),this.add(this.background),this.fill=new l.GameObjects.Rectangle(e,u==="left"?this.width/7:0,0,this.barCurrent,a,d).setOrigin(0).setMask(this.geometryMask),this.add(this.fill),this.icon=new l.GameObjects.Sprite(this.scene,u==="left"?0:this.width/7*6+5,5,M).setOrigin(0),this.add(this.icon),this.icon.displayWidth=this.width/7-5,this.icon.displayHeight=this.height-10,this.icon.setTintFill(this.fillColor),this.text=new l.GameObjects.Text(e,u==="left"?this.width/2+this.width/7/2:this.width/2-this.width/7/2,a/2,`${this.current}/${this.max}`,H).setOrigin(.5),this.add(this.text)}}const D=6,m=Math.floor(600/D);class g extends l.GameObjects.Container{constructor(e,s,i,r,a){super(e,i+m/4,r);t(this,"id");t(this,"column");t(this,"intersector");t(this,"intersectoryOverlay");t(this,"shouldAnimate",!1);t(this,"pointerDownFunc",(e,s,i,r)=>{l.Geom.Circle.ContainsPoint(new l.Geom.Circle(this.x,this.y,Math.floor(m/2*.8)),e)&&this.scene.events.emit("setStartingDragTile",this)});t(this,"pointerMoveFunc",(e,s,i,r)=>{l.Geom.Circle.ContainsPoint(new l.Geom.Circle(this.x,this.y,Math.floor(m/2*.8)),e)&&this.scene.events.emit("draggingIntersect",this)});t(this,"pointerUpFunc",(e,s,i,r)=>{});t(this,"onSetDim",()=>{this.alpha=.3});t(this,"onUnsetDim",()=>{this.alpha=1});this.setSize(m,m),this.on("pointerup",this.pointerUpFunc),this.on("pointerdown",this.pointerDownFunc),this.on("pointermove",this.pointerMoveFunc),this.on("dim",this.onSetDim),this.on("undim",this.onUnsetDim),this.setInteractive(),this.id=s,this.column=a}}const b=["combat","currency","healing","defence","enemy"],T=n=>n.tileType==="enemy",j=n=>n.tileType==="healing",$=n=>n.tileType==="currency",B=n=>n.tileType==="combat",I=n=>n.tileType==="defence",R=6,C=Math.floor(600/R);class y extends Phaser.GameObjects.Sprite{constructor(e,s){super(e,0,0,s);this.setOrigin(0),this.setDisplaySize(C,C)}}const F={fontFamily:"'Lato', sans-serif",fontSize:"1.5rem",stroke:"#000",strokeThickness:5};class E extends g{constructor(e){super(e.scene,e.id,e.x,e.y,e.column);t(this,"tileType","enemy");t(this,"tileName","skull");t(this,"maxHp");t(this,"level");t(this,"xpReward");t(this,"damage");t(this,"spawnedThisTurn");t(this,"sprite");t(this,"text");t(this,"destroy",()=>new Promise((e,s)=>{var a,h;let i=this.scene.add.sprite(this.x,this.y,this.tileName);i.displayHeight=this.height,i.displayWidth=this.width;const r=this.scene;super.destroy(),r.tweens.add({targets:i,props:{x:{value:(a=r.xpBar)==null?void 0:a.getIconCenter().x,duration:400,ease:"Sine"},y:{value:(h=r.xpBar)==null?void 0:h.getIconCenter().y,duration:400,ease:"Power2"},scale:{value:.1,duration:400,ease:"Power2"}},onComplete:(d,c)=>(c.forEach(o=>o.destroy()),e())})}));t(this,"attackAnimation",e=>new Promise((s,i)=>{this.bringToTop(this.sprite),this.bringToTop(this.text),this.scene.tweens.add({targets:[this.sprite,this.text],ease:"Quint.easeInOut",duration:150,props:{y:{value:"-=50"}},yoyo:!0,onComplete:()=>s()})}));this.maxHp=5,this.level=3,this.xpReward=4,this.damage=1,this.spawnedThisTurn=!0,this.setDataEnabled(),this.data.set("currentHp",5),this.sprite=new y(e.scene,this.tileName),this.sprite.setOrigin(.5),this.add(this.sprite),this.text=new l.GameObjects.Text(e.scene,-this.displayOriginX,this.displayOriginY/2-5,`${this.currentHp}`,F),this.text.setDepth(100),this.add(this.text),this.data.events.on("changedata-currentHp",()=>{this.text.text=`${this.currentHp}`})}get currentHp(){return this.data.get("currentHp")}set currentHp(e){this.data.set("currentHp",e)}}class N extends g{constructor(e){super(e.scene,e.id,e.x,e.y,e.column);t(this,"tileType","combat");t(this,"tileName","sword");t(this,"damage");t(this,"sprite");this.damage=1,this.sprite=new y(e.scene,this.tileName),this.sprite.setOrigin(.5),this.add(this.sprite)}}class X extends g{constructor(e){super(e.scene,e.id,e.x,e.y,e.column);t(this,"tileType","healing");t(this,"tileName","healthPotion");t(this,"healAmount");t(this,"sprite");t(this,"destroy",()=>new Promise((e,s)=>{var a,h;let i=this.scene.add.sprite(this.x,this.y,this.tileName);i.displayHeight=this.height,i.displayWidth=this.width;const r=this.scene;super.destroy(),r.tweens.add({targets:i,props:{x:{value:(a=r.healthBar)==null?void 0:a.getIconCenter().x,duration:400,ease:"Sine"},y:{value:(h=r.healthBar)==null?void 0:h.getIconCenter().y,duration:400,ease:"Power2"},scale:{value:.1,duration:400,ease:"Power2"}},onComplete:(d,c)=>(c.forEach(o=>o.destroy()),e())})}));this.healAmount=2,this.sprite=new y(e.scene,this.tileName),this.sprite.setOrigin(.5),this.add(this.sprite)}}class U extends g{constructor(e){super(e.scene,e.id,e.x,e.y,e.column);t(this,"tileType","defence");t(this,"tileName","shield");t(this,"defenceMod");t(this,"sprite");t(this,"destroy",()=>new Promise((e,s)=>{var a,h;let i=this.scene.add.sprite(this.x,this.y,this.tileName);i.displayHeight=this.height,i.displayWidth=this.width;const r=this.scene;super.destroy(),r.tweens.add({targets:i,props:{x:{value:(a=r.defenceBar)==null?void 0:a.getIconCenter().x,duration:400,ease:"Sine"},y:{value:(h=r.defenceBar)==null?void 0:h.getIconCenter().y,duration:400,ease:"Power2"},scale:{value:.1,duration:400,ease:"Power2"}},onComplete:(d,c)=>(c.forEach(o=>o.destroy()),e())})}));this.defenceMod=1,this.sprite=new y(e.scene,this.tileName),this.sprite.setOrigin(.5),this.add(this.sprite)}}class _ extends g{constructor(e){super(e.scene,e.id,e.x,e.y,e.column);t(this,"tileType","currency");t(this,"tileName","coin");t(this,"goldValue");t(this,"sprite");t(this,"destroy",()=>new Promise((e,s)=>{let i=this.scene.add.sprite(this.x,this.y,this.tileName);i.displayHeight=this.height,i.displayWidth=this.width;const r=this.scene;super.destroy(),r.tweens.add({targets:i,props:{x:{value:r.goldIcon.x+22,duration:400,ease:"Sine"},y:{value:r.goldIcon.y+22,duration:400,ease:"Power2"},scale:{value:.1,duration:400,ease:"Power2"}},onComplete:(a,h)=>(h.forEach(d=>d.destroy()),e())})}));this.goldValue=f.exports.Math.Between(1,6),this.sprite=new y(e.scene,this.tileName),this.sprite.setOrigin(.5),this.add(this.sprite)}}const z=6,W=Math.floor(600/z);class V{constructor(e){t(this,"scene");t(this,"currentDelta",0);t(this,"GenerateRandomTile",(e,s=200)=>{this.currentDelta++;const i=b[l.Math.RND.between(0,b.length-1)],r=new g(this.scene,this.currentDelta,e*W,s,e);switch(i){case"enemy":return new E(r);case"combat":return new N(r);case"healing":return new X(r);case"defence":return new U(r);case"currency":return new _(r);default:throw new Error("INVALID TILE TYPE :(")}});this.scene=e}}class Y extends L{constructor(e){super();t(this,"game");t(this,"tilesToRemove");t(this,"next_playerTurn",()=>"tileActions");t(this,"enter_playerTurn",()=>{console.log(this.game.tiles)});t(this,"exit_playerTurn",()=>{});t(this,"next_tileActions",()=>"removeAndReplaceTile");t(this,"enter_tileActions",()=>{const e=this.game.selectedTiles.filter(s=>s.tileType=="combat").length;this.game.selectedTiles.forEach((s,i)=>{T(s)&&(s.currentHp-=e+this.game.playerDamage,s.currentHp<=0&&(this.game.playerXp+=s.xpReward,this.tilesToRemove.push(s))),j(s)&&(this.game.playerCurrentHp+=s.healAmount,this.game.playerCurrentHp>this.game.playerHp?this.game.playerCurrentHp=this.game.playerHp:s.shouldAnimate=!0,this.tilesToRemove.push(s)),B(s)&&this.tilesToRemove.push(s),$(s)&&(this.game.playerGold+=s.goldValue,s.shouldAnimate=!0,this.tilesToRemove.push(s)),I(s)&&(this.game.playerCurrentShield+=s.defenceMod,this.game.playerCurrentShield>this.game.playerShield?this.game.playerCurrentShield=this.game.playerShield:s.shouldAnimate=!0,this.tilesToRemove.push(s))}),this.next()});t(this,"exit_tileActions",()=>{});t(this,"next_removeAndReplaceTile",()=>"enemyTurn");t(this,"enter_removeAndReplaceTile",async()=>{const e=[];this.tilesToRemove.forEach(async(s,i)=>{var a;this.game.tiles=[...this.game.tiles.filter(h=>h.id!==s.id)],e.push(s.destroy());var r=this.game.tileFactory.GenerateRandomTile(s.column);this.game.tiles.push(r),(a=this.game.tilesLayer)==null||a.add(this.game.tiles[this.game.tiles.length-1]),this.game.matter.add.gameObject(this.game.tiles[this.game.tiles.length-1])}),await Promise.all(e),this.next()});t(this,"exit_removeAndReplaceTile",()=>{this.tilesToRemove=[]});t(this,"next_enemyTurn",()=>"playerTurn");t(this,"enter_enemyTurn",async()=>{var s;let e=[];((s=this.game.tiles)==null?void 0:s.some(i=>T(i)))&&this.game.tiles.filter(r=>T(r)).forEach((r,a)=>{const h=r;if(h.spawnedThisTurn){h.spawnedThisTurn=!1;return}if(e.push(h.attackAnimation()),this.game.playerCurrentShield>0){this.game.playerCurrentShield-=1;return}this.game.playerCurrentHp-=h.damage}),await Promise.all(e),this.next()});t(this,"exit_enemyTurn",()=>{});this.game=e,this.tilesToRemove=[]}}const q=()=>{const n=550;let e=[];for(let s=0;s<200;s++)if(s===0)e.push(0);else if(s===1)e.push(0);else{let i=s+80,r=Math.floor(Math.pow(n*(s*1.016),i*.008));e.push(Math.floor(r/9+e[s-1]))}return console.log(e),e},k=q(),K=(n,e)=>e>=k[n+1];var Q={XpTable:k,DidLevelUp:K};const J={fontFamily:"'Lato', sans-serif",fontSize:"2rem",stroke:"#000",strokeThickness:2};class Z extends l.GameObjects.Container{constructor(e,s,i,r,a,h=16711680,d=65280,c,o="left"){super(e,s,i);t(this,"width");t(this,"height");t(this,"graphicMask");t(this,"geometryMask");t(this,"background");t(this,"backgroundColor");t(this,"fill");t(this,"fillColor");t(this,"text");t(this,"icon");t(this,"max");t(this,"current");t(this,"barMax");t(this,"barCurrent");t(this,"incrementAmount");t(this,"getIconCenter",()=>({x:this.x+this.icon.x+this.icon.displayWidth/2,y:this.y+this.icon.y+this.icon.displayHeight/2}));t(this,"setProgress",e=>{this.current=e,this.barCurrent=Math.floor(this.max/100*e),this.text.text=`${e}%`,this.scene.tweens.add({targets:this.fill,props:{width:{value:`${this.barCurrent}`,duration:300,ease:"Power2"}}})});t(this,"increaseProgress",e=>{this.current+=e,this.barCurrent+=e*this.incrementAmount,this.text.text=`${this.current}/${this.max}`,this.scene.tweens.add({targets:this.fill,props:{width:{value:`+=${e*this.incrementAmount}`,duration:300,ease:"Power2"}}})});t(this,"decreaseProgress",e=>{this.current-=e,this.barCurrent-=e*this.incrementAmount,this.text.text=`${this.current}/${this.max}`,this.scene.tweens.add({targets:this.fill,props:{width:{value:`-=${e*this.incrementAmount}`,duration:300,ease:"Power2"}}})});this.width=r,this.height=a,this.backgroundColor=h,this.fillColor=d,this.max=r/7*6,this.current=0,this.incrementAmount=r/7*6/this.max,this.barMax=this.incrementAmount*this.max,this.barCurrent=this.current*this.incrementAmount,this.graphicMask=new l.GameObjects.Graphics(e).fillRoundedRect(o==="left"?this.width/7+s:s,i,this.width/7*6,a,10),this.geometryMask=new f.exports.Display.Masks.GeometryMask(e,this.graphicMask),this.background=new l.GameObjects.Rectangle(e,o==="left"?this.width/7:0,0,this.width/7*6,a,h).setOrigin(0).setMask(this.geometryMask),this.add(this.background),this.fill=new l.GameObjects.Rectangle(e,o==="left"?this.width/7:0,0,this.barCurrent,a,d).setOrigin(0).setMask(this.geometryMask),this.add(this.fill),this.icon=new l.GameObjects.Sprite(this.scene,o==="left"?0:this.width/7*6+5,5,c).setOrigin(0),this.add(this.icon),this.icon.displayWidth=this.width/7-5,this.icon.displayHeight=this.height-10,this.icon.setTintFill(this.fillColor),this.text=new l.GameObjects.Text(e,o==="left"?this.width/2+this.width/7/2:this.width/2-this.width/7/2,a/2,`${Math.floor(this.current/this.max)}%`,J).setOrigin(.5),this.add(this.text)}}const x={fontFamily:"'Lato', sans-serif",fontSize:"2rem",stroke:"#000",strokeThickness:2},w=6,p=Math.floor(600/w);class ee extends l.Scene{constructor(){super("GameScene");t(this,"state");t(this,"xpTable");t(this,"collisionGroup");t(this,"tileFactory");t(this,"isDragging",!1);t(this,"dragPoints",[]);t(this,"selectedTiles",[]);t(this,"dragLine");t(this,"dragLineFill");t(this,"dragLinePath");t(this,"startingTileType");t(this,"tiles",[]);t(this,"tileBoxGraphic");t(this,"tilesLayer");t(this,"tilesLayerMask");t(this,"healthBar");t(this,"defenceBar");t(this,"xpBar");t(this,"goldIcon");t(this,"goldText");t(this,"levelIcon");t(this,"levelText");t(this,"preload",()=>{this.load.image("coin","assets/coin.svg"),this.load.image("sword","assets/gladius.svg"),this.load.image("healthPotion","assets/health-potion.svg"),this.load.image("shield","assets/shield.svg"),this.load.image("skull","assets/skull-white.svg"),this.load.image("healthCross","assets/health-cross.svg"),this.load.image("xpIcon","assets/xp-icon.svg"),this.load.image("defenceIcon","assets/defence-icon.svg"),this.load.image("moneyBag","assets/money-bag.svg"),this.load.spritesheet("slash","assets/slashes_meme.png",{frameWidth:64,frameHeight:64})});t(this,"create",()=>{this.initializeDataAccessors(),this.state=new Y(this),this.buildUi(),this.buildGrid(),this.registerCollisions(),this.registerHandlers(),this.registerAnimations(),this.state.start("playerTurn")});t(this,"update",(e,s)=>{});t(this,"buildUi",()=>{this.healthBar=new v(this,5,5,Math.floor(this.sys.canvas.width/2-20),50,2600544,3066993,30,30,"healthCross","left"),this.add.existing(this.healthBar),this.defenceBar=new v(this,5,70,Math.floor(this.sys.canvas.width/2-20),50,2719929,3447003,10,10,"defenceIcon","left"),this.add.existing(this.defenceBar),this.xpBar=new Z(this,5,135,Math.floor(this.sys.canvas.width/2-20),50,9323693,10840509,"xpIcon","left"),this.add.existing(this.xpBar),this.levelIcon=new l.GameObjects.Text(this,5,190,"Lv.",x).setOrigin(0),this.add.existing(this.levelIcon),this.levelText=new l.GameObjects.Text(this,50,190,`${this.data.get("playerLevel")}`,x).setOrigin(0),this.add.existing(this.levelText),this.goldIcon=new l.GameObjects.Sprite(this,5,235,"moneyBag").setTintFill(15844367).setOrigin(0),this.goldIcon.displayHeight=35,this.goldIcon.displayWidth=35,this.add.existing(this.goldIcon),this.goldText=new l.GameObjects.Text(this,50,235,`${this.data.get("playerGold")}`,x).setOrigin(0),this.add.existing(this.goldText),this.tileBoxGraphic=new l.GameObjects.Rectangle(this,0,300,p*6,p*6,2899536).setOrigin(0).setDepth(-1).setName("container-mask"),this.add.existing(this.tileBoxGraphic),this.tilesLayer=this.add.layer();const e=new l.GameObjects.Graphics(this);e.fillRect(0,300,p*6,p*6),this.tilesLayerMask=e.createGeometryMask(),this.tilesLayer.setMask(this.tilesLayerMask)});t(this,"buildGrid",()=>{var i;let e=0;for(let r=0;r<w;r++)for(let a=0;a<w;a++){var s=this.tileFactory.GenerateRandomTile(r,a);T(s)&&(s.spawnedThisTurn=!1),this.tiles.push(s),(i=this.tilesLayer)==null||i.add(this.tiles[e]),e++}});t(this,"updateDragLine",(e=!1)=>{var s,i,r,a;e&&(this.selectedTiles.pop(),this.dragPoints.pop()),(s=this.dragLine)==null||s.clear(),(i=this.dragLine)==null||i.lineStyle(16,0,1),(r=this.dragLineFill)==null||r.clear(),(a=this.dragLineFill)==null||a.lineStyle(8,16777215,1),this.dragLinePath=new l.Curves.Path(this.selectedTiles[0].x,this.selectedTiles[0].y),this.dragLinePath.splineTo(this.dragPoints.map(h=>new l.Math.Vector2(h.x,h.y))),this.dragLinePath.draw(this.dragLine,128),this.dragLinePath.draw(this.dragLineFill,128)});t(this,"dimTiles",e=>{this.checkMatchingTileType(e)&&this.tiles.filter(s=>!this.checkMatchingTileType(s.tileType)).forEach((s,i)=>s.emit("dim"))});t(this,"undimTiles",e=>{this.checkMatchingTileType(e)&&this.tiles.filter(s=>!this.checkMatchingTileType(s.tileType)).forEach((s,i)=>s.emit("undim"))});t(this,"initializeDataAccessors",()=>{this.data.set("playerDamage",1),this.data.set("playerHp",20),this.events.on("changedata-playerHp",(e,s)=>{var i;(i=this.healthBar)==null||i.setMax(s)}),this.data.set("playerCurrentHp",20),this.events.on("changedata-playerCurrentHp",(e,s)=>{var i;(i=this.healthBar)==null||i.setProgress(s)}),this.data.set("playerShield",10),this.events.on("changedata-playerShield",(e,s)=>{var i;(i=this.defenceBar)==null||i.setMax(s)}),this.data.set("playerCurrentShield",10),this.events.on("changedata-playerCurrentShield",(e,s)=>{var i;(i=this.defenceBar)==null||i.setProgress(s)}),this.data.set("playerLevel",1),this.events.on("changedata-playerLevel",(e,s)=>{var i;(i=this.levelText)==null||i.setText(s.toString())}),this.data.set("playerXp",0),this.events.on("changedata-playerXp",(e,s)=>{var i;this.playerXp>this.xpTable[this.playerLevel+1]&&(console.log("levelled up"),this.playerLevel++,this.levelUpThreshhold=this.xpTable[this.playerLevel+1]),(i=this.xpBar)==null||i.setProgress(Math.floor((this.playerXp-this.xpTable[this.playerLevel])/(this.xpTable[this.playerLevel+1]-this.xpTable[this.playerLevel])*100))}),this.data.set("levelUpThreshhold",this.xpTable[this.playerLevel+1]),this.events.on("changedata-levelUpThreshhold",(e,s)=>{}),this.data.set("playerGold",0),this.events.on("changedata-playerGold",(e,s)=>{var i;(i=this.goldText)==null||i.setText(s.toString())})});t(this,"registerCollisions",()=>{this.matter.world.setBounds(),this.tiles.forEach((e,s)=>{this.matter.add.gameObject(e)})});t(this,"registerHandlers",()=>{this.events.on("setStartingDragTile",e=>{var s;((s=this.state)==null?void 0:s.state)==="playerTurn"&&(this.startingTileType=e.tileType,this.selectedTiles.push(e),this.dragPoints.push({x:e.x,y:e.y}),this.dragLine=this.add.graphics(),this.dragLineFill=this.add.graphics(),this.dimTiles(this.startingTileType))}),this.events.on("draggingIntersect",e=>{var s;if(((s=this.state)==null?void 0:s.state)==="playerTurn"){if(this.selectedTiles.length<1)return;if(this.selectedTiles.some(i=>i.id==e.id))this.selectedTiles.length>1&&e.id==this.selectedTiles[this.selectedTiles.length-2].id&&this.updateDragLine(!0);else{let i=e.x-this.dragPoints[this.dragPoints.length-1].x,r=e.y-this.dragPoints[this.dragPoints.length-1].y;r>p*1.2||r<-(p*1.2)||i>p*1.2||i<-(p*1.2)?console.log("DISTANCE TOO LARGE"):(this.checkIntersectedTile(e),this.updateDragLine())}}}),this.input.on("pointerup",e=>{var s,i,r,a,h;((s=this.state)==null?void 0:s.state)==="playerTurn"&&(this.selectedTiles.length>2&&((i=this.state)==null||i.next()),this.selectedTiles=[],this.dragPoints=[],(r=this.dragLine)==null||r.destroy(),(a=this.dragLinePath)==null||a.destroy(),(h=this.dragLineFill)==null||h.destroy(),this.undimTiles(this.startingTileType))})});t(this,"registerAnimations",()=>{this.anims.create({key:"slash",frames:this.anims.generateFrameNumbers("slash",{frames:[0,1,2,3,4,5,6,7,8]})})});t(this,"checkMatchingTileType",e=>{switch(e){case"combat":if(this.startingTileType==="enemy"||this.startingTileType==="combat")return!0;case"enemy":if(this.startingTileType==="enemy"||this.startingTileType==="combat")return!0;case"currency":if(this.startingTileType==e)return!0;case"defence":if(this.startingTileType==e)return!0;case"healing":if(this.startingTileType==e)return!0}});t(this,"checkIntersectedTile",e=>{this.checkMatchingTileType(e.tileType)&&(this.selectedTiles.push(e),this.dragPoints.push({x:e.x,y:e.y}))});this.tileFactory=new V(this),this.xpTable=Q.XpTable}get playerHp(){return this.data.get("playerHp")}set playerHp(e){this.data.set("playerHp",e)}get playerCurrentHp(){return this.data.get("playerCurrentHp")}set playerCurrentHp(e){this.data.set("playerCurrentHp",e)}get playerShield(){return this.data.get("playerShield")}set playerShield(e){this.data.set("playerShield",e)}get playerCurrentShield(){return this.data.get("playerCurrentShield")}set playerCurrentShield(e){this.data.set("playerCurrentShield",e)}get playerXp(){return this.data.get("playerXp")}set playerXp(e){this.data.set("playerXp",e)}get levelUpThreshhold(){return this.data.get("levelUpThreshhold")}set levelUpThreshhold(e){this.data.set("levelUpThreshhold",e)}get playerGold(){return this.data.get("playerGold")}set playerGold(e){this.data.set("playerGold",e)}get playerLevel(){return this.data.get("playerLevel")}set playerLevel(e){this.data.set("playerLevel",e)}get playerDamage(){return this.data.get("playerDamage")}set playerDamage(e){this.data.set("playerDamage",e)}}G.addListener("backButton",n=>{console.log("back")});new l.Game(Object.assign(A,{scene:[ee]}));
